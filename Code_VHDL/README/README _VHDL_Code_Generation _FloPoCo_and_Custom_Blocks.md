# VHDL Generation Automation Script

## ğŸ¯ Objective

This script automates the generation of **synthesizable VHDL files** for both:

- Custom-designed blocks (**my own implementation**)  
- Blocks generated by **FloPoCo**  

---

## ğŸ“‚ Directory Structure

```
project/
â”œâ”€â”€ generate_vhdl.py          â† Python script to launch generation
â”œâ”€â”€ template/                 â† Contains VHDL template files
â”‚   â”œâ”€â”€ top_add_template.vhd
â”‚   â”œâ”€â”€ top_mult_template.vhd
â”‚   â”œâ”€â”€ top_mac_template.vhd
â”‚   â”œâ”€â”€ top_flopoco_fpadd_template.vhd
â”‚   â”œâ”€â”€ top_flopoco_fpmult_template.vhd
â”‚   â””â”€â”€ top_flopoco_fpmac_template.vhd
â””â”€â”€ vhdl_files/
    â”œâ”€â”€ my_code/              â† My custom VHDL top-level designs
    â”‚   â”œâ”€â”€ top_Add_Test.vhd
    â”‚   â”œâ”€â”€ top_Mult_Test.vhd
    â”‚   â””â”€â”€ top_MAC_Test.vhd
    â””â”€â”€ flopoco/              â† FloPoCo VHDL + integrated top-levels
        â”œâ”€â”€ top_FPAdd_Test.vhd
        â”œâ”€â”€ top_FPMult_Test.vhd
        â””â”€â”€ top_FPMAC_Test.vhd
```

---

## âš ï¸ How to Generate Files

From the `project/` directory, run:

- **For personal code**:
```bash
python3 generate_vhdl.py MYCODE
```

- **For FloPoCo code**:
```bash
python3 generate_vhdl.py FLOPOCO <frequency_value>
```

**Examples:**
```bash
python3 generate_vhdl.py MYCODE       # For my code
python3 generate_vhdl.py FLOPOCO 300  # For FloPoCo
```

---

## âš ï¸ Script Tasks

### 1ï¸âƒ£ FloPoCo Blocks

- Calls FloPoCo using command line (e.g., `flopoco IEEEFPAdd ...`)  
- Moves the generated `flopoco.vhdl` into a build directory  
- Merges the generated code with a VHDL top-level template  
- Saves the full file into:  
```
vhdl_files/flopoco/top_<Component>_Test.vhd
```

### 2ï¸âƒ£ Custom Blocks

- Loads your **custom top-level template**  
- Replaces placeholders (e.g., `{{ENTITY_NAME}}`, `{{EXP_WIDTH}}`, etc.)  
- Saves the result into:  
```
vhdl_files/my_code/top_<Block>_Test.vhd
```

---

## âš™ï¸ Parameters

Inside `generate_vhdl.py`, you can customize each block like this:

**Example for custom blocks:**
```json
{
  "name": "Add",
  "template": "top_add_template.vhd",
  "exp_width": 5,
  "mant_width": 10,
  "DECAL": 29
}
```

**Example for FloPoCo blocks:**
```json
{
  "component": "FPMAC",
  "template": "top_flopoco_fpmac_template.vhd",
  "flopoco_cmd": "IEEEFPFMA",
  "exp_width": 5,
  "mant_width": 10,
  "name": "FPMAC16"
}
```

---

## âš ï¸ Important Notes

- Change **only** the `exp_width` and `mant_width` parameters.  
- For the parameter `DECAL`:
  - Float16 â†’ keep it at **29**  
  - Float32 â†’ **253**  
  - Bfloat â†’ **253**  
  - Double â†’ **2045**
